function  [x,err, J2, denCond] =  RA34_step_HIRES (fun,t0,h,x0)

dim = length(x0);
I = eye(dim);
dx = x0;
   dx(1) = -1.71*x0(1) + 0.43*x0(2) + 8.32*x0(3) + 0.0007;
   dx(2) = 1.71*x0(1) - 8.75*x0(2);
   dx(3) = -10.03*x0(3) + 0.43*x0(4) + 0.035*x0(5);
   dx(4) = 8.32*x0(2) + 1.71*x0(3) - 1.12*x0(4);
   dx(5) = -1.745*x0(5) + 0.43*x0(6) + 0.43*x0(7);
   dx(6) = -280*x0(6)*x0(8) + 0.69*x0(4) + 1.71*x0(5)  - 0.43*x0(6) + 0.69*x0(7);
   dx(7) = 280*x0(6)*x0(8) - 1.81*x0(7);
   dx(8) = -280*x0(6)*x0(8) + 1.81*x0(7);
  
f0 = dx;

J=[ -1.71 0.43 8.32 0 0 0 0 0; 
    1.71 -8.75 0 0 0 0 0 0;
    0 0 -10.03 0.43 0.035 0 0 0;
    0 8.32 1.71 -1.12 0 0 0 0;
    0 0 0 0 -1.745 0.43 0.43 0;
    0 0 0 0.69 1.71 (-280*x0(8)-0.43) 0.69 (-280*x0(6));
    0 0 0 0 0 (280*x0(8)) -1.81 (280*x0(6));
    0 0 0 0 0 (-280*x0(8)) 1.81 (-280*x0(6))];


dJ = [ 0 0 0 0 0 0 0 0; 
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 (-280*dx(8)) 0 (-280*dx(6));
    0 0 0 0 0 (280*dx(8)) 0 (280*dx(6));
    0 0 0 0 0 (-280*dx(8)) 0 (-280*dx(6))];

dj66 = 78400*x0(8)*dx(6) - 506.8*dx(7) + 78400*x0(6)*dx(8);
dj68= -280*0.69*dx(4) - 280*1.71*dx(5)  - 280*(- 0.43  - 280*x0(8))*dx(6)  - 280*0.69*dx(7) + 78400*x0(6)*dx(8);
dj76 = -dj66;
dj78 = -dj68;

dj86 = dj66;
dj88 = dj68;
ddJ=  [ 0 0 0 0 0 0 0 0; 
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0;
    0 0 0 0 0 dj66 0 dj68;
    0 0 0 0 0 dj76 0 dj78;
    0 0 0 0 0 dj86 0 dj88];

ddf = (J^2 + dJ);
d3f = ddJ + 2*dJ*J + 2*J*dJ +  J^3;

Dnum4 = (I + h^2*(-1/4*J^2 + 1/3*ddf))*h*f0;
Den4 = I - 0.5*h*J + h^2/6*ddf - h^3/24*d3f;

denCond = cond(Den4);

dx = Den4\Dnum4;
x = x0 + dx; %4 ord

Den3 = I - 0.5*h*J + h^2/6*ddf;
dx = Den3\Dnum4;

x2 = x0 + dx; %3 ord

J2=J;
err = x - x2;

end